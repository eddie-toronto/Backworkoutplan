<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Back Workout Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }
        
        /* App Banner - Fixed at top */
        .app-banner {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 15px 20px;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .app-banner-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .app-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .app-title h1 {
            font-size: 1.2em;
            font-weight: 600;
        }
        
        .app-stats {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 0.9em;
        }
        
        .streak-display {
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .header-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .menu-button {
            background: none;
            border: none;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: background-color 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
        }
        
        .menu-button:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .auth-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 6px 12px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.8em;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .auth-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* Main Content Area */
        .main-content {
            margin-top: 70px;
            padding: 20px 20px 100px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Day Banner - Progressive Disclosure Implementation */
        .day-banner {
            position: sticky;
            top: 70px;
            background: white;
            border-radius: 0 0 15px 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            border-left: 4px solid #3498db;
            z-index: 500;
            transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
        }
        
        .day-banner.minimized {
            padding: 12px 20px;
            border-radius: 0;
            box-shadow: 0 1px 5px rgba(0,0,0,0.1);
        }
        
        .day-banner-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }
        
        .day-banner.minimized .day-banner-header {
            margin-bottom: 0;
            align-items: center;
        }
        
        .day-info {
            flex: 1;
        }
        
        .day-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #2c3e50;
            transition: all 0.3s ease;
        }
        
        .day-banner.minimized .day-title {
            font-size: 1em;
        }
        
        .day-subtitle {
            color: #7f8c8d;
            font-size: 0.9em;
            margin-top: 5px;
            transition: all 0.3s ease;
            opacity: 1;
            max-height: 20px;
            overflow: hidden;
        }
        
        .day-banner.minimized .day-subtitle {
            opacity: 0;
            max-height: 0;
            margin-top: 0;
        }
        
        /* Timer Controls Section */
        .timer-controls-section {
            margin-bottom: 15px;
            transition: all 0.3s ease;
            opacity: 1;
            max-height: 60px;
            overflow: hidden;
        }
        
        .day-banner.minimized .timer-controls-section {
            opacity: 0;
            max-height: 0;
            margin-bottom: 0;
        }
        
        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .timer-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9em;
            transition: all 0.3s ease;
            min-width: 80px;
            min-height: 44px;
        }
        
        .start-btn {
            background: #2ecc71;
            color: white;
        }
        
        .start-btn:hover {
            background: #27ae60;
        }
        
        .pause-btn {
            background: #f39c12;
            color: white;
        }
        
        .pause-btn:hover {
            background: #e67e22;
        }
        
        .stop-btn {
            background: #e74c3c;
            color: white;
        }
        
        .stop-btn:hover {
            background: #c0392b;
        }
        
        /* Timer Display Section */
        .timer-display-section {
            text-align: center;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }
        
        .day-banner.minimized .timer-display-section {
            text-align: right;
        }
        
        .timer-display {
            font-size: 2.5em;
            font-weight: bold;
            color: #2c3e50;
            font-family: 'Courier New', monospace;
            transition: all 0.3s ease;
            margin-bottom: 5px;
        }
        
        .day-banner.minimized .timer-display {
            font-size: 1.2em;
            margin-bottom: 0;
        }
        
        .timer-status {
            font-size: 0.9em;
            color: #7f8c8d;
            transition: all 0.3s ease;
            opacity: 1;
            max-height: 20px;
            overflow: hidden;
        }
        
        .day-banner.minimized .timer-status {
            opacity: 0;
            max-height: 0;
        }
        
        /* Workout Banner - Individual exercises */
        .workout-banner {
            background: white;
            border-radius: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            overflow: hidden;
        }
        
        .exercise-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .exercise-info h3 {
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        
        .exercise-info p {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .exercise-number {
            background: rgba(255,255,255,0.2);
            padding: 8px 12px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .exercise-content {
            padding: 20px;
        }
        
        /* Set Management */
        .sets-container {
            margin-bottom: 20px;
        }
        
        .set-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 15px;
            margin: 8px 0;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .set-item.completed {
            background: #d5f4e6;
            border-left-color: #2ecc71;
        }
        
        .set-item.active {
            background: #e3f2fd;
            border-left-color: #3498db;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.2);
        }
        
        .set-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .set-label {
            font-weight: 600;
            color: #2c3e50;
            min-width: 60px;
        }
        
        .rep-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .rep-btn {
            width: 35px;
            height: 35px;
            border: 2px solid #3498db;
            background: white;
            color: #3498db;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .rep-btn:hover {
            background: #3498db;
            color: white;
        }
        
        .rep-count {
            font-size: 1.2em;
            font-weight: bold;
            color: #2c3e50;
            min-width: 30px;
            text-align: center;
        }
        
        .complete-set-btn {
            background: #2ecc71;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }
        
        .complete-set-btn:hover {
            background: #27ae60;
        }
        
        .complete-set-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
        
        /* Video Section */
        .video-section {
            margin-top: 20px;
            border-top: 1px solid #e9ecef;
            padding-top: 20px;
        }
        
        .video-container {
            border-radius: 8px;
            overflow: hidden;
        }
        
        .video-container iframe {
            width: 100%;
            height: 200px;
            border: none;
        }
        
        /* Home Page */
        .home-container {
            display: none;
        }
        
        .home-container.active {
            display: block;
        }
        
        .welcome-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            text-align: center;
        }
        
        .quick-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .action-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .action-btn:hover {
            background: #2980b9;
        }
        
        /* Navigation drawer styles remain the same */
        .nav-drawer {
            position: fixed;
            top: 0;
            right: -320px;
            width: 320px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 15px rgba(0,0,0,0.3);
            z-index: 1500;
            transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
            display: flex;
            flex-direction: column;
        }
        
        .nav-drawer.open {
            transform: translateX(-320px);
        }
        
        .nav-drawer-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.5);
            z-index: 1400;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .nav-drawer-overlay.open {
            opacity: 1;
            visibility: visible;
        }
        
        /* State indicator */
        .state-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2ecc71;
            color: white;
            padding: 8px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        
        /* Mobile responsiveness */
        @media (max-width: 600px) {
            .timer-controls {
                flex-direction: row;
                gap: 8px;
            }
            
            .timer-btn {
                flex: 1;
                min-width: 0;
                padding: 12px 8px;
                font-size: 0.9em;
            }
            
            .day-banner-header {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }
            
            .timer-display {
                font-size: 2em;
            }
            
            .day-banner.minimized .timer-display {
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <!-- App Banner -->
    <div class="app-banner">
        <div class="app-banner-content">
            <div class="app-title">
                <span>💪</span>
                <h1>Back Workout Tracker</h1>
            </div>
            <div class="header-controls">
                <div class="streak-display">
                    🔥 <span id="streakCount">0</span>
                </div>
                <div class="auth-info" id="authInfo">
                    <button class="auth-btn" onclick="alert('Authentication coming soon!')">Login</button>
                </div>
                <button class="menu-button" onclick="toggleDrawer()">
                    <span id="menuIcon">☰</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Navigation Drawer -->
    <div class="nav-drawer" id="navDrawer">
        <div style="padding: 20px; border-bottom: 1px solid #eee;">
            <h3>Navigation</h3>
            <button style="float: right; background: none; border: none; font-size: 1.5em; cursor: pointer;" onclick="closeDrawer()">✕</button>
        </div>
        <div style="flex: 1; padding: 20px;">
            <button onclick="navigateToSection('home')" style="display: block; width: 100%; margin: 10px 0; padding: 15px; background: #f8f9fa; border: none; border-radius: 8px; cursor: pointer;">
                🏠 Home
            </button>
            <button onclick="navigateToSection('dayA')" style="display: block; width: 100%; margin: 10px 0; padding: 15px; background: #f8f9fa; border: none; border-radius: 8px; cursor: pointer;">
                💪 Day A - Vertical Pull
            </button>
            <button onclick="navigateToSection('dayB')" style="display: block; width: 100%; margin: 10px 0; padding: 15px; background: #f8f9fa; border: none; border-radius: 8px; cursor: pointer;">
                🏋️ Day B - Horizontal Pull
            </button>
            <button onclick="navigateToSection('dayC')" style="display: block; width: 100%; margin: 10px 0; padding: 15px; background: #f8f9fa; border: none; border-radius: 8px; cursor: pointer;">
                ⚡ Day C - Power & Mixed
            </button>
        </div>
    </div>
    
    <!-- Navigation Drawer Overlay -->
    <div class="nav-drawer-overlay" id="navDrawerOverlay" onclick="closeDrawer()"></div>

    <!-- Main Content Area -->
    <div class="main-content">
        <!-- Home Section -->
        <div id="homeSection" class="home-container active">
            <div class="welcome-section">
                <h2>Welcome Back!</h2>
                <p style="color: #7f8c8d; margin-bottom: 20px;">Ready to build that V-back?</p>
                
                <div class="quick-actions">
                    <button class="action-btn" onclick="showSection('dayA')">
                        🚀 Start Day A
                    </button>
                    <button class="action-btn" onclick="showSection('dayB')">
                        🚀 Start Day B
                    </button>
                    <button class="action-btn" onclick="showSection('dayC')">
                        🚀 Start Day C
                    </button>
                </div>
            </div>
        </div>

        <!-- Day A Section -->
        <div id="dayASection" class="workout-container" style="display: none;">
            <div class="day-banner" id="dayABanner">
                <div class="day-banner-header">
                    <div class="day-info">
                        <h2 class="day-title">Day A: Vertical Pull Focus</h2>
                        <p class="day-subtitle">Building pull-up strength and lat development</p>
                    </div>
                    <div class="timer-display-section">
                        <div class="timer-display" id="timerDisplay">00:00</div>
                        <div class="timer-status" id="timerStatus">Ready to start</div>
                    </div>
                </div>
                
                <div class="timer-controls-section">
                    <div class="timer-controls">
                        <button class="timer-btn start-btn" onclick="startTimer()">Start</button>
                        <button class="timer-btn pause-btn" onclick="pauseTimer()">Pause</button>
                        <button class="timer-btn stop-btn" onclick="stopTimer()">Complete</button>
                    </div>
                </div>
            </div>
            
            <div id="dayAExercises">
                <!-- Exercises will be loaded here -->
            </div>
        </div>

        <!-- Day B Section -->
        <div id="dayBSection" class="workout-container" style="display: none;">
            <div class="day-banner" id="dayBBanner">
                <div class="day-banner-header">
                    <div class="day-info">
                        <h2 class="day-title">Day B: Horizontal Pull & Barbell</h2>
                        <p class="day-subtitle">Building back thickness and strength</p>
                    </div>
                    <div class="timer-display-section">
                        <div class="timer-display" id="timerDisplayB">00:00</div>
                        <div class="timer-status" id="timerStatusB">Ready to start</div>
                    </div>
                </div>
                
                <div class="timer-controls-section">
                    <div class="timer-controls">
                        <button class="timer-btn start-btn" onclick="startTimer()">Start</button>
                        <button class="timer-btn pause-btn" onclick="pauseTimer()">Pause</button>
                        <button class="timer-btn stop-btn" onclick="stopTimer()">Complete</button>
                    </div>
                </div>
            </div>
            
            <div id="dayBExercises">
                <!-- Exercises will be loaded here -->
            </div>
        </div>

        <!-- Day C Section -->
        <div id="dayCSection" class="workout-container" style="display: none;">
            <div class="day-banner" id="dayCBanner">
                <div class="day-banner-header">
                    <div class="day-info">
                        <h2 class="day-title">Day C: Power & Mixed Patterns</h2>
                        <p class="day-subtitle">Building explosive power and overall strength</p>
                    </div>
                    <div class="timer-display-section">
                        <div class="timer-display" id="timerDisplayC">00:00</div>
                        <div class="timer-status" id="timerStatusC">Ready to start</div>
                    </div>
                </div>
                
                <div class="timer-controls-section">
                    <div class="timer-controls">
                        <button class="timer-btn start-btn" onclick="startTimer()">Start</button>
                        <button class="timer-btn pause-btn" onclick="pauseTimer()">Pause</button>
                        <button class="timer-btn stop-btn" onclick="stopTimer()">Complete</button>
                    </div>
                </div>
            </div>
            
            <div id="dayCExercises">
                <!-- Exercises will be loaded here -->
            </div>
        </div>
    </div>

    <!-- State Indicator -->
    <div class="state-indicator" id="stateIndicator">
        ✅ Ready
    </div>

    <script>
        // Enhanced workout data matching your vanilla-js implementation
        const workoutData = {
            A: [
                { 
                    name: 'Pull-ups', 
                    description: 'Vertical pulling movement for lat development. Focus on full range of motion and controlled tempo.',
                    sets: 3, 
                    targetReps: [8, 6, 4], 
                    videoUrl: 'https://www.youtube.com/watch?v=eGo4IYlbE5g',
                    equipment: 'pull-up bar',
                    muscleGroups: ['lats', 'rhomboids', 'middle traps', 'biceps']
                },
                { 
                    name: 'Lat Pulldowns', 
                    description: 'Machine-based vertical pull. Use wide grip and focus on pulling elbows down and back.',
                    sets: 3, 
                    targetReps: [10, 8, 6], 
                    videoUrl: 'https://www.youtube.com/watch?v=CAwf7n6Luuc',
                    equipment: 'cable machine',
                    muscleGroups: ['lats', 'rear delts', 'biceps']
                },
                { 
                    name: 'Cable Rows', 
                    description: 'Horizontal pulling for thickness. Keep chest up and squeeze shoulder blades together.',
                    sets: 3, 
                    targetReps: [12, 10, 8], 
                    videoUrl: 'https://www.youtube.com/watch?v=GZbfZ033f74',
                    equipment: 'cable machine',
                    muscleGroups: ['rhomboids', 'middle traps', 'rear delts', 'biceps']
                }
            ],
            B: [
                { 
                    name: 'Barbell Rows', 
                    description: 'Compound horizontal pulling movement. Maintain neutral spine and pull bar to lower chest.',
                    sets: 3, 
                    targetReps: [8, 6, 5], 
                    videoUrl: 'https://www.youtube.com/watch?v=9efgcAjQe7E',
                    equipment: 'barbell',
                    muscleGroups: ['rhomboids', 'middle traps', 'lats', 'rear delts']
                },
                { 
                    name: 'T-Bar Rows', 
                    description: 'Heavy horizontal pulling with neutral grip. Focus on driving elbows back.',
                    sets: 3, 
                    targetReps: [10, 8, 6], 
                    videoUrl: 'https://www.youtube.com/watch?v=j3Igk5nyZE4',
                    equipment: 'T-bar row machine',
                    muscleGroups: ['rhomboids', 'middle traps', 'lats']
                },
                { 
                    name: 'Dumbbell Rows', 
                    description: 'Unilateral horizontal pulling. Focus on full range of motion and controlled tempo.',
                    sets: 3, 
                    targetReps: [12, 10, 8], 
                    videoUrl: 'https://www.youtube.com/watch?v=roCP6wCXPqo',
                    equipment: 'dumbbells',
                    muscleGroups: ['lats', 'rhomboids', 'rear delts', 'biceps']
                }
            ],
            C: [
                { 
                    name: 'Deadlifts', 
                    description: 'King of back exercises. Focus on hip hinge pattern and maintaining neutral spine.',
                    sets: 3, 
                    targetReps: [5, 3, 2], 
                    videoUrl: 'https://www.youtube.com/watch?v=op9kVnSso6Q',
                    equipment: 'barbell',
                    muscleGroups: ['erector spinae', 'lats', 'traps', 'rhomboids']
                },
                { 
                    name: 'Rack Pulls', 
                    description: 'Partial deadlift from elevated position. Focus on lockout strength and trap development.',
                    sets: 3, 
                    targetReps: [6, 4, 3], 
                    videoUrl: 'https://www.youtube.com/watch?v=ZWi2ZcXMMJ4',
                    equipment: 'barbell, power rack',
                    muscleGroups: ['upper traps', 'erector spinae', 'lats']
                },
                { 
                    name: 'Chin-ups', 
                    description: 'Underhand grip pull-up variation. More bicep involvement and slightly different lat activation.',
                    sets: 3, 
                    targetReps: [8, 6, 4], 
                    videoUrl: 'https://www.youtube.com/watch?v=brhRXlOhkAM',
                    equipment: 'pull-up bar',
                    muscleGroups: ['lats', 'biceps', 'rhomboids']
                }
            ]
        };

        // App state
        let appState = {
            currentSection: 'home',
            currentDay: 'A',
            timer: {
                elapsed: 0,
                isRunning: false,
                interval: null
            },
            workout: {
                active: false,
                startTime: null,
                exercises: {}
            }
        };

        // Timer functions
        function updateTimerDisplay() {
            const minutes = Math.floor(appState.timer.elapsed / 60);
            const seconds = appState.timer.elapsed % 60;
            const timeString = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Update all timer displays
            document.querySelectorAll('[id^="timerDisplay"]').forEach(display => {
                display.textContent = timeString;
            });
        }

        function startTimer() {
            if (!appState.timer.isRunning) {
                appState.timer.isRunning = true;
                appState.workout.active = true;
                
                if (!appState.workout.startTime) {
                    appState.workout.startTime = Date.now();
                }
                
                appState.timer.interval = setInterval(() => {
                    appState.timer.elapsed++;
                    updateTimerDisplay();
                }, 1000);
            }
        }

        function pauseTimer() {
            if (appState.timer.isRunning) {
                appState.timer.isRunning = false;
                clearInterval(appState.timer.interval);
            }
        }

        function stopTimer() {
            appState.timer.isRunning = false;
            clearInterval(appState.timer.interval);
            appState.timer.elapsed = 0;
            appState.workout.active = false;
            appState.workout.startTime = null;
            appState.workout.exercises = {};
            
            updateTimerDisplay();
        }

        // Exercise loading function
        function loadExercises(day) {
            const container = document.getElementById(`day${day}Exercises`);
            const exercises = workoutData[day];
            
            if (!container || !exercises) {
                console.error(`Cannot load exercises for day ${day}:`, { container: !!container, exercises: !!exercises });
                return;
            }
            
            container.innerHTML = exercises.map((exercise, exerciseIndex) => {
                const exerciseKey = `${day}-${exerciseIndex}`;
                const exerciseState = appState.workout.exercises[exerciseKey] || {
                    sets: exercise.targetReps.map(() => ({ reps: 0, completed: false })),
                    currentSet: 0
                };
                
                return `
                    <div class="workout-banner">
                        <div class="exercise-header">
                            <div class="exercise-info">
                                <h3>${exercise.name}</h3>
                                <p>${exercise.description}</p>
                            </div>
                            <div class="exercise-number">${exerciseIndex + 1}</div>
                        </div>
                        
                        <div class="exercise-content">
                            <div class="exercise-meta">
                                <div style="margin-bottom: 10px; font-size: 0.9em; color: #666;">
                                    <strong>🏋️ Equipment:</strong> ${exercise.equipment}<br>
                                    <strong>🎯 Targets:</strong> ${exercise.muscleGroups.join(', ')}
                                </div>
                            </div>
                            
                            <div class="sets-container">
                                ${exerciseState.sets.map((set, setIndex) => `
                                    <div class="set-item ${set.completed ? 'completed' : ''} ${setIndex === exerciseState.currentSet ? 'active' : ''}" 
                                         data-exercise="${exerciseKey}" data-set="${setIndex}">
                                        <div class="set-info">
                                            <div class="set-label">Set ${setIndex + 1}</div>
                                            <div style="font-size: 0.8em; color: #666;">Target: ${exercise.targetReps[setIndex]} reps</div>
                                        </div>
                                        <div class="rep-controls">
                                            <button class="rep-btn" onclick="adjustReps('${exerciseKey}', ${setIndex}, -1)">-</button>
                                            <div class="rep-count">${set.reps}</div>
                                            <button class="rep-btn" onclick="adjustReps('${exerciseKey}', ${setIndex}, 1)">+</button>
                                            <button class="complete-set-btn" 
                                                    onclick="completeSet('${exerciseKey}', ${setIndex})"
                                                    ${set.completed ? 'disabled' : ''}>
                                                ${set.completed ? '✅ Done' : 'Complete Set'}
                                            </button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                            
                            ${exercise.videoUrl ? `
                                <div class="video-section">
                                    <div class="video-container">
                                        <iframe src="${convertToEmbedUrl(exercise.videoUrl)}" allowfullscreen></iframe>
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            }).join('');
            
            // Initialize exercise state if not exists
            exercises.forEach((exercise, exerciseIndex) => {
                const exerciseKey = `${day}-${exerciseIndex}`;
                if (!appState.workout.exercises[exerciseKey]) {
                    appState.workout.exercises[exerciseKey] = {
                        sets: exercise.targetReps.map(() => ({ reps: 0, completed: false })),
                        currentSet: 0
                    };
                }
            });
        }

        // Utility function to convert YouTube URLs to embed format
        function convertToEmbedUrl(url) {
            if (!url) return '';
            
            let videoId = '';
            
            if (url.includes('youtube.com/watch')) {
                videoId = url.split('v=')[1]?.split('&')[0];
            } else if (url.includes('youtu.be/')) {
                videoId = url.split('youtu.be/')[1]?.split('?')[0];
            } else if (url.includes('youtube.com/shorts/')) {
                videoId = url.split('shorts/')[1]?.split('?')[0];
            } else if (url.includes('youtube.com/embed/')) {
                return url;
            }
            
            return videoId ? `https://www.youtube.com/embed/${videoId}` : url;
        }

        // Exercise management functions
        function adjustReps(exerciseKey, setIndex, change) {
            if (!appState.workout.exercises[exerciseKey]) return;
            
            const currentReps = appState.workout.exercises[exerciseKey].sets[setIndex].reps;
            const newReps = Math.max(0, currentReps + change);
            
            appState.workout.exercises[exerciseKey].sets[setIndex].reps = newReps;
            
            // Update display
            const setElement = document.querySelector(`[data-exercise="${exerciseKey}"][data-set="${setIndex}"]`);
            if (setElement) {
                setElement.querySelector('.rep-count').textContent = newReps;
            }
        }

        function completeSet(exerciseKey, setIndex) {
            if (!appState.workout.exercises[exerciseKey]) return;
            
            const exerciseState = appState.workout.exercises[exerciseKey];
            const set = exerciseState.sets[setIndex];
            
            if (set.reps === 0) {
                alert('Please enter the number of reps you completed before marking the set as complete.');
                return;
            }
            
            // Mark set as completed
            set.completed = true;
            
            // Move to next incomplete set
            const nextIncompleteSet = exerciseState.sets.findIndex((s, index) => 
                index > setIndex && !s.completed
            );
            
            if (nextIncompleteSet !== -1) {
                exerciseState.currentSet = nextIncompleteSet;
            }
            
            // Update display
            const setElement = document.querySelector(`[data-exercise="${exerciseKey}"][data-set="${setIndex}"]`);
            if (setElement) {
                setElement.classList.add('completed');
                setElement.classList.remove('active');
                
                const button = setElement.querySelector('.complete-set-btn');
                button.textContent = '✅ Done';
                button.disabled = true;
            }
            
            // Activate next set
            if (nextIncompleteSet !== -1) {
                const nextSetElement = document.querySelector(`[data-exercise="${exerciseKey}"][data-set="${nextIncompleteSet}"]`);
                if (nextSetElement) {
                    nextSetElement.classList.add('active');
                }
            }
        }

        // Navigation functions
        function showSection(sectionName) {
            console.log('Switching to section:', sectionName);
            
            // Hide all sections first
            document.querySelectorAll('.home-container, .workout-container').forEach(section => {
                section.style.display = 'none';
                if (section.classList) {
                    section.classList.remove('active');
                }
            });
            
            // Reset all banners to expanded state
            document.querySelectorAll('.day-banner').forEach(banner => {
                banner.classList.remove('minimized');
            });
            
            // Update the app state
            appState.currentSection = sectionName;
            
            // Show the correct section
            if (sectionName === 'home') {
                const homeSection = document.getElementById('homeSection');
                if (homeSection) {
                    homeSection.style.display = 'block';
                    homeSection.classList.add('active');
                }
            } else if (sectionName.startsWith('day')) {
                const day = sectionName.replace('day', '');
                const daySection = document.getElementById(`day${day}Section`);
                
                if (daySection) {
                    daySection.style.display = 'block';
                    console.log(`Showing ${sectionName} section`);
                    
                    // Setup scroll handling for this section
                    setTimeout(() => {
                        setupScrollHandling();
                    }, 100);
                }
                
                // Update app state to track current workout day
                appState.currentDay = day;
                
                // Load the exercises for this specific day
                setTimeout(() => {
                    loadExercises(day);
                }, 50);
            }
            
            // Update the timer display
            updateTimerDisplay();
        }

        // Scroll-based banner minimization
        function setupScrollHandling() {
            let ticking = false;
            
            function updateBannerState() {
                const currentSection = appState.currentSection;
                if (!currentSection || !currentSection.startsWith('day')) {
                    return;
                }
                
                const banner = document.getElementById(`${currentSection}Banner`);
                if (!banner) return;
                
                const scrollY = window.scrollY;
                const shouldMinimize = scrollY > 50;
                
                if (shouldMinimize && !banner.classList.contains('minimized')) {
                    banner.classList.add('minimized');
                } else if (!shouldMinimize && banner.classList.contains('minimized')) {
                    banner.classList.remove('minimized');
                }
                
                ticking = false;
            }
            
            function onScroll() {
                if (!ticking) {
                    requestAnimationFrame(updateBannerState);
                    ticking = true;
                }
            }
            
            // Remove any existing scroll listeners
            window.removeEventListener('scroll', onScroll);
            
            // Add scroll listener
            window.addEventListener('scroll', onScroll);
            
            // Initial state check
            updateBannerState();
        }

        // Navigation drawer functions
        function toggleDrawer() {
            const drawer = document.getElementById('navDrawer');
            const isOpen = drawer.classList.contains('open');
            
            if (isOpen) {
                closeDrawer();
            } else {
                openDrawer();
            }
        }

        function openDrawer() {
            const drawer = document.getElementById('navDrawer');
            const overlay = document.getElementById('navDrawerOverlay');
            const menuIcon = document.getElementById('menuIcon');
            
            drawer.classList.add('open');
            overlay.classList.add('open');
            menuIcon.textContent = '✕';
            document.body.style.overflow = 'hidden';
        }

        function closeDrawer() {
            const drawer = document.getElementById('navDrawer');
            const overlay = document.getElementById('navDrawerOverlay');
            const menuIcon = document.getElementById('menuIcon');
            
            drawer.classList.remove('open');
            overlay.classList.remove('open');
            menuIcon.textContent = '☰';
            document.body.style.overflow = '';
        }

        function navigateToSection(sectionName) {
            closeDrawer();
            showSection(sectionName);
        }

        // Initialize app
        function initApp() {
            console.log('App initialized');
            updateTimerDisplay();
        }

        // Start app when page loads
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
